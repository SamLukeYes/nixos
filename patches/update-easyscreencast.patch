From 39189ee9b74e56c0c4c38e23290a3b4d91d4e1f1 Mon Sep 17 00:00:00 2001
From: winston <hey@winston.sh>
Date: Fri, 14 Nov 2025 21:32:18 +0100
Subject: [PATCH] gnomeExtensions.easyScreenCast: 1.11.1 -> 1.12.0

---
 .../extensions/EasyScreenCast/default.nix     |  4 +-
 .../EasyScreenCast/fix-gi-path.patch          | 51 +++++--------------
 2 files changed, 14 insertions(+), 41 deletions(-)

diff --git a/pkgs/desktops/gnome/extensions/EasyScreenCast/default.nix b/pkgs/desktops/gnome/extensions/EasyScreenCast/default.nix
index 90ccde4c4d180..d80c4faaec908 100644
--- a/pkgs/desktops/gnome/extensions/EasyScreenCast/default.nix
+++ b/pkgs/desktops/gnome/extensions/EasyScreenCast/default.nix
@@ -12,13 +12,13 @@
 
 stdenv.mkDerivation (finalAttrs: {
   pname = "gnome-shell-extension-EasyScreenCast";
-  version = "1.11.1";
+  version = "1.12.0";
 
   src = fetchFromGitHub {
     owner = "EasyScreenCast";
     repo = "EasyScreenCast";
     rev = finalAttrs.version;
-    hash = "sha256-G4JDxaUfipn9asOXGw+OPVULOdV+OmzeK5aE/FSPGes=";
+    hash = "sha256-+DVuUClLhPEVN2VIBkJJI51V9TTS5Q9y6wflEGyt6AY=";
   };
 
   patches = [
diff --git a/pkgs/desktops/gnome/extensions/EasyScreenCast/fix-gi-path.patch b/pkgs/desktops/gnome/extensions/EasyScreenCast/fix-gi-path.patch
index b47d2b52a7d78..376df7eb8e13c 100644
--- a/pkgs/desktops/gnome/extensions/EasyScreenCast/fix-gi-path.patch
+++ b/pkgs/desktops/gnome/extensions/EasyScreenCast/fix-gi-path.patch
@@ -1,8 +1,8 @@
-diff --git i/extension.js w/extension.js
-index c151057..1b6dfc3 100644
---- i/extension.js
-+++ w/extension.js
-@@ -717,7 +717,7 @@ const EasyScreenCastIndicator = GObject.registerClass({
+diff --git a/extension.js b/extension.js
+index 32a7c7c..a7ed98e 100644
+--- a/extension.js
++++ b/extension.js
+@@ -720,7 +720,7 @@ const EasyScreenCastIndicator = GObject.registerClass({
              Lib.TalkativeLog('-*-execute post command');
  
              // launch cmd after registration
@@ -11,22 +11,11 @@ index c151057..1b6dfc3 100644
  
              const mapObj = {
                  _fpath: pathFile,
-diff --git i/prefs.js w/prefs.js
-index e0dd1a2..9dcb87a 100644
---- i/prefs.js
-+++ w/prefs.js
-@@ -13,8 +13,8 @@
- 'use strict';
- 
- import GIRepository from 'gi://GIRepository';
--GIRepository.Repository.prepend_search_path('/usr/lib64/gnome-shell');
--GIRepository.Repository.prepend_library_path('/usr/lib64/gnome-shell');
-+GIRepository.Repository.prepend_search_path('@gnomeShell@/lib/gnome-shell');
-+GIRepository.Repository.prepend_library_path('@gnomeShell@/lib/gnome-shell');
- 
- import Adw from 'gi://Adw';
- import GObject from 'gi://GObject';
-@@ -713,7 +713,7 @@ const EasyScreenCastSettingsWidget = GObject.registerClass({
+diff --git a/prefs.js b/prefs.js
+index b58b160..2298d5a 100644
+--- a/prefs.js
++++ b/prefs.js
+@@ -709,7 +709,7 @@ const EasyScreenCastSettingsWidget = GObject.registerClass({
                  Lib.TalkativeLog('-^-NOT SET xdg-user video');
  
                  ctx.CtrlExe.Execute(
@@ -35,7 +24,7 @@ index e0dd1a2..9dcb87a 100644
                      true,
                      (success, out) => {
                          Lib.TalkativeLog(`-^-CALLBACK sync S: ${success} out: ${out}`);
-@@ -883,7 +883,7 @@ const EasyScreenCastSettingsWidget = GObject.registerClass({
+@@ -879,7 +879,7 @@ const EasyScreenCastSettingsWidget = GObject.registerClass({
                  );
  
                  ctx.CtrlExe.Execute(
@@ -44,20 +33,4 @@ index e0dd1a2..9dcb87a 100644
                      false,
                      success => {
                          Lib.TalkativeLog(`-^-CALLBACK async S= ${success}`);
-diff --git i/utilaudio.js w/utilaudio.js
-index b07e181..ed7d3ba 100644
---- i/utilaudio.js
-+++ w/utilaudio.js
-@@ -14,10 +14,8 @@
- 
- import GObject from 'gi://GObject';
- import GIRepository from 'gi://GIRepository';
--GIRepository.Repository.prepend_search_path('/usr/lib/gnome-shell');
--GIRepository.Repository.prepend_library_path('/usr/lib/gnome-shell');
--GIRepository.Repository.prepend_search_path('/usr/lib64/gnome-shell');
--GIRepository.Repository.prepend_library_path('/usr/lib64/gnome-shell');
-+GIRepository.Repository.prepend_search_path('@gnomeShell@/lib/gnome-shell');
-+GIRepository.Repository.prepend_library_path('@gnomeShell@/lib/gnome-shell');
- import Gvc from 'gi://Gvc';
- 
- import * as Lib from './convenience.js';
+
