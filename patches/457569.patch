From b2d43223a765606a4198810681d6b21b8cb8c027 Mon Sep 17 00:00:00 2001
From: SamLukeYes <samlukeyes123@gmail.com>
Date: Sat, 1 Nov 2025 23:47:35 +0800
Subject: [PATCH 1/2] pacman: 7.0.0 -> 7.1.0

---
 pkgs/by-name/pa/pacman/dont-create-empty-dirs.patch | 13 +++++++++++--
 pkgs/by-name/pa/pacman/package.nix                  |  8 ++------
 2 files changed, 13 insertions(+), 8 deletions(-)

diff --git a/pkgs/by-name/pa/pacman/dont-create-empty-dirs.patch b/pkgs/by-name/pa/pacman/dont-create-empty-dirs.patch
index 59deb947bb5db..7deaf0448ba13 100644
--- a/pkgs/by-name/pa/pacman/dont-create-empty-dirs.patch
+++ b/pkgs/by-name/pa/pacman/dont-create-empty-dirs.patch
@@ -1,8 +1,17 @@
 diff --git a/meson.build b/meson.build
-index c8ee42fd..610401ca 100644
+index 1e8bd8f8..86e68a75 100644
 --- a/meson.build
 +++ b/meson.build
-@@ -414,15 +414,6 @@ install_data(
+@@ -433,8 +433,6 @@ configure_file(
+   configuration : substs,
+   install_dir : join_paths(SYSCONFDIR, 'makepkg.conf.d/'))
+ 
+-install_emptydir(join_paths(SYSCONFDIR, 'makepkg.d/'))
+-
+ configure_file(
+   input : 'etc/pacman.conf.in',
+   output : 'pacman.conf',
+@@ -448,15 +446,6 @@ install_data(
    'proto/proto.install',
    install_dir : join_paths(DATAROOTDIR, 'pacman'))
  
diff --git a/pkgs/by-name/pa/pacman/package.nix b/pkgs/by-name/pa/pacman/package.nix
index e73805e5e1a98..43e910c01bb5c 100644
--- a/pkgs/by-name/pa/pacman/package.nix
+++ b/pkgs/by-name/pa/pacman/package.nix
@@ -41,14 +41,14 @@
 
 stdenv.mkDerivation (final: {
   pname = "pacman";
-  version = "7.0.0";
+  version = "7.1.0";
 
   src = fetchFromGitLab {
     domain = "gitlab.archlinux.org";
     owner = "pacman";
     repo = "pacman";
     rev = "v${final.version}";
-    hash = "sha256-ejOBxN2HjV4dZwFA7zvPz3JUJa0xiJ/jZ+evEQYG1Mc=";
+    hash = "sha256-bGg2ZrIsEYJYZCLsIh4FZROhpyLSBO0Lar1mSoz66wI=";
   };
 
   strictDeps = true;
@@ -101,10 +101,6 @@ stdenv.mkDerivation (final: {
         --replace-fail "/bin/true" "${coreutils}/bin/true"
       substituteInPlace scripts/repo-add.sh.in \
         --replace-fail bsdtar "${libarchive}/bin/bsdtar"
-
-      # Fix https://gitlab.archlinux.org/pacman/pacman/-/issues/171
-      substituteInPlace scripts/libmakepkg/source/git.sh.in \
-        --replace-warn "---mirror" "--mirror"
     '';
 
   mesonFlags = [

From 7b9c9f2d1f8f23d78bd97fa5a3d21d548651a26c Mon Sep 17 00:00:00 2001
From: SamLukeYes <samlukeyes123@gmail.com>
Date: Sun, 25 Jan 2026 13:40:23 +0800
Subject: [PATCH 2/2] paru: 2.1.0 -> 2.1.0-unstable-2026-01-09

---
 pkgs/by-name/pa/paru/package.nix | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/pkgs/by-name/pa/paru/package.nix b/pkgs/by-name/pa/paru/package.nix
index 1f86b25602a8f..d0e9f45a29d92 100644
--- a/pkgs/by-name/pa/paru/package.nix
+++ b/pkgs/by-name/pa/paru/package.nix
@@ -12,16 +12,16 @@
 
 rustPlatform.buildRustPackage rec {
   pname = "paru";
-  version = "2.1.0";
+  version = "2.1.0-unstable-2026-01-09";
 
   src = fetchFromGitHub {
     owner = "Morganamilo";
     repo = "paru";
-    tag = "v${version}";
-    hash = "sha256-i99f2ngYhfVCKpImJ8L7u2T2FgOt7Chp8DHDbrNh1kw=";
+    rev = "9ac3578807a87858651e81a02586ceb947686e7c";
+    hash = "sha256-TJbhxVnP5UhlCmwxKjXq/XaqPGtzHoN5S+lizm3Bmvs=";
   };
 
-  cargoHash = "sha256-USIceRh24WGV0TIrpuyHs4thjaghpxqZmk2uVKBxlm4=";
+  cargoHash = "sha256-Shp/2jQtO3pulT2gmsAcsEVPpv76nbEiGol+kYD7kr8=";
 
   nativeBuildInputs = [
     gettext
